(()=>{var H=Object.defineProperty,X=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var J=(t,e,o)=>e in t?H(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,p=(t,e)=>{for(var o in e||(e={}))ee.call(e,o)&&J(t,o,e[o]);if(A)for(var o of A(e))te.call(e,o)&&J(t,o,e[o]);return t},U=(t,e)=>X(t,Z(e));var y=(t,e)=>()=>(t&&(e=t(t=0)),e);var ne=(t,e)=>{for(var o in e)H(t,o,{get:e[o],enumerable:!0})};function u(t,e="success"){let o=document.createElement("div");o.textContent=t,o.className=`fixed bottom-8 left-1/2 transform -translate-x-1/2 px-4 py-2 rounded shadow-lg z-50 text-white text-sm animate-fadeIn ${e==="error"?"bg-red-600":"bg-green-600"}`,document.body.appendChild(o),setTimeout(()=>{o.classList.add("animate-fadeOut")},2500),setTimeout(()=>{o.remove()},3e3)}var E=y(()=>{});function m(){return JSON.parse(localStorage.getItem("interactions"))||[]}function I(t){localStorage.setItem("interactions",JSON.stringify(t))}function f(){let t=new Date;return`${String(t.getMonth()+1).padStart(2,"0")}_${String(t.getDate()).padStart(2,"0")}_${t.getFullYear()}`}function W(t="import-json"){let e=document.getElementById(t);e&&e.addEventListener("change",o=>{let n=o.target.files[0];if(!n)return;let s=new FileReader;s.onload=i=>{try{let r=JSON.parse(i.target.result),d=r.data||r;if(!Array.isArray(d)){u("Invalid backup format.");return}let c=m(),a=oe(c,d);I(a),u("Data imported successfully!"),setTimeout(()=>location.reload(),1500)}catch(r){u("Failed to parse backup file.")}},s.readAsText(n)})}function oe(t,e){let o=new Map;return t.forEach(n=>o.set(n.date,n)),e.forEach(n=>{if(o.has(n.date)){let s=o.get(n.date),i=new Set(s.interactions.map(d=>d.id)),r=n.interactions.filter(d=>!i.has(d.id));s.interactions.push(...r)}else o.set(n.date,n)}),Array.from(o.values())}function C(){return JSON.parse(localStorage.getItem("suggestions")||'{"reason-for-calling":[],"findings":[],"resolution":[]}')}function _(t){localStorage.setItem("suggestions",JSON.stringify(t))}var x=y(()=>{E()});var z={};ne(z,{createExportPopup:()=>re,displayInteractions:()=>g,setupSidebarToggle:()=>k});function g(t=f()){let e=document.getElementById("card-list"),n=m().find(i=>i.date===t);if(!n){e.innerHTML='<p class="text-gray-500 text-center">No interactions found for this date.</p>';return}let s=document.getElementById("interaction-card");e.innerHTML="",n.interactions.sort((i,r)=>new Date(r.datetime)-new Date(i.datetime)).forEach(i=>{let r=s.content.cloneNode(!0),d=r.querySelector(".card");d.dataset.id=i.id,i.completed&&(d.classList.add("bg-green-100"),d.querySelector(".done-button").classList.add("text-green-600"),d.querySelectorAll("button").forEach(a=>{a.classList.remove("hover:bg-blue-600","hover:bg-green-600","hover:bg-red-600"),a.classList.add("opacity-50","cursor-default")}),d.classList.add("completed-card")),r.querySelector(".reason").textContent=i.reason||"",r.querySelector(".datetime").textContent=`Date: ${new Date(i.datetime).toLocaleString()}`,r.querySelector(".calling-number").textContent=i.cn?`Calling Number: ${i.cn}`:"",r.querySelector(".incident-number").textContent=i.in?`Incident Number: ${i.in}`:"",r.querySelector(".name").textContent=i.name?`Name: ${i.name}`:"",r.querySelector(".findings").textContent=i.findings?`Findings: ${i.findings}`:"",r.querySelector(".resolution").textContent=i.resolution?`Resolution: ${i.resolution}`:"";let c=r.querySelector(".button-container");c.innerHTML=`
              <button class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-2 py-0.5 rounded text-sm copy-incident" title="Copy incident number">#</button>
              <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mx-2 copy-btn">Copy</button>
              <button class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded mx-2 clone-btn" title="Duplicate this card">Clone</button>
              <button class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded mx-2 update-btn">Update</button>
              <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded mx-2 delete-btn">Delete</button>
            `,d.querySelector(".done-button").addEventListener("click",()=>se(i.id)),c.querySelector(".copy-incident").addEventListener("click",()=>{navigator.clipboard.writeText(i.in||"").then(()=>u("Incident Number copied"),()=>u("Failed to copy Incident Number"))}),c.querySelector(".copy-btn").addEventListener("click",()=>ie(i.id)),c.querySelector(".update-btn").addEventListener("click",()=>{N(i,()=>g(t));let a=document.getElementById("interaction-form");a&&(a.scrollIntoView({behavior:"smooth",block:"start"}),a.classList.add("ring","ring-yellow-400","ring-offset-2"),setTimeout(()=>{a.classList.remove("ring","ring-yellow-400","ring-offset-2")},1500))}),c.querySelector(".delete-btn").addEventListener("click",()=>ae(i.id)),c.querySelector(".clone-btn").addEventListener("click",()=>{let a=m(),L=a.findIndex(l=>l.date===t);if(L!==-1){let l=i,b=`${Date.now()}`,M=U(p({},l),{id:b,datetime:new Date().toISOString(),completed:!1,cn:"",in:"",name:"",reason:l.reason?`${l.reason} (cloned)`:"(cloned)"});a[L].interactions.unshift(M),localStorage.setItem("interactions",JSON.stringify(a)),g(t),setTimeout(()=>{let S=document.querySelector(`[data-id="${b}"]`);S&&(S.scrollIntoView({behavior:"smooth",block:"center"}),S.classList.add("ring","ring-yellow-400","ring-offset-2"),setTimeout(()=>{S.classList.remove("ring","ring-yellow-400","ring-offset-2")},1500)),N(M)},100)}}),e.appendChild(r)})}function B(t){let n=m().flatMap(s=>s.interactions).find(s=>s.id===t);return n?[n.cn&&`Calling Number: ${n.cn}`,n.in&&`Incident Number: ${n.in}`,n.name&&`Name: ${n.name}`,n.reason&&`Reason for Calling: ${n.reason}`,n.findings&&`Findings: ${n.findings}`,n.resolution&&`Resolution: ${n.resolution}`].filter(Boolean).join(`
`):""}function ie(t){let e=B(t);navigator.clipboard.writeText(e).then(()=>u("Copied to clipboard"),()=>u("Copy failed"))}function se(t){let e=m(),o=f(),n=e.find(s=>s.date===o);if(n){let s=n.interactions.find(i=>i.id===t);s&&(s.completed=!s.completed),I(e),g(o)}}function ae(t){let e=m(),o=f(),n=e.find(s=>s.date===o);n&&(n.interactions=n.interactions.filter(s=>s.id!==t),I(e),g(o))}function re(){let t=document.createElement("div");t.className="absolute left-20 bottom-10 bg-white border rounded shadow-lg z-50 w-48 text-sm",[{label:"Today (Text)",value:"today"},{label:"All (Text)",value:"allText"},{label:"All Data (JSON)",value:"allJSON"}].forEach(o=>{let n=document.createElement("button");n.textContent=o.label,n.className="w-full text-left px-4 py-2 hover:bg-gray-100",n.onclick=()=>{de(o.value),document.body.removeChild(t)},t.appendChild(n)}),document.body.appendChild(t),document.addEventListener("click",o=>{t.contains(o.target)||t.remove()},{once:!0})}function de(t){let e=m(),o=f();if(t==="today"){let n=e.find(i=>i.date===o);if(!n)return;let s=n.interactions.map(i=>B(i.id)).join(`

--------------------------------------------------------

`);T(s,`interactions_${o}.txt`)}else if(t==="allText"){let n=e.map(s=>{let i=`Date: ${s.date}`,r=s.interactions.map(d=>B(d.id)).join(`

--------------------------------------------------------

`);return`${i}

${r}`}).join(`

============================================================

`);T(n,"interactions_all.txt")}else if(t==="allJSON"){let n=JSON.stringify({data:e},null,2);T(n,"interactions_all.json","application/json")}}function T(t,e,o="text/plain"){let n=new Blob([t],{type:o}),s=URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s)}function k(){let t=document.querySelector("#toggle-sidebar"),e=document.querySelector("#sidebar");t&&e&&t.addEventListener("click",()=>{let o=e.classList.contains("hidden");console.log("Toggling sidebar before:",e.classList),o?(e.classList.remove("hidden"),e.classList.add("flex"),e.classList.add("md:flex")):(e.classList.add("hidden"),e.classList.remove("flex"),e.classList.remove("md:flex")),console.log("Toggling sidebar after:",e.classList)})}var $,P,le,ce,ue,h,me,v=y(()=>{x();q();E();x();$=document.getElementById("suggestion-modal"),P=document.getElementById("suggestion-textarea"),le=document.getElementById("save-suggestions"),ce=document.getElementById("close-modal"),ue=document.getElementById("modal-title"),h=null,me={"reason-for-calling":"Reason for Calling",findings:"Findings",resolution:"Resolution"};window.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".suggestion-icon").forEach(e=>{e.addEventListener("click",()=>{h=e.getAttribute("data-field");let o=C();P.value=(o[h]||[]).join(`
`),ue.textContent=`Edit Suggestions: ${me[h]}`,$.classList.remove("hidden")})}),le.addEventListener("click",()=>{if(!h)return;let e=P.value.split(`
`).map(n=>n.trim()).filter(Boolean),o=C();o[h]=e,_(o),$.classList.add("hidden")}),ce.addEventListener("click",()=>{$.classList.add("hidden")}),document.querySelectorAll(".suggest-input").forEach(e=>{let o=e.getAttribute("data-field"),n=document.querySelector(`.suggestions-list[data-for="${o}"]`);e.addEventListener("input",()=>{let s=C()[o]||[],i=e.value.toLowerCase();if(n.innerHTML="",!i)return n.classList.add("hidden");let r=s.filter(c=>c.toLowerCase().includes(i));if(r.length===0)return n.classList.add("hidden");r.forEach(c=>{let a=document.createElement("li");a.textContent=c,a.className="px-2 py-1 cursor-pointer hover:bg-blue-100",a.addEventListener("click",()=>{e.value=c,n.classList.add("hidden")}),n.appendChild(a)});let d=e.getBoundingClientRect();n.style.position="absolute",n.style.top=`${e.offsetTop+e.offsetHeight+4}px`,n.style.left=`${e.offsetLeft}px`,n.style.width=`${e.offsetWidth}px`,n.classList.remove("hidden")}),e.addEventListener("blur",()=>setTimeout(()=>n.classList.add("hidden"),200))})})});function D(t,e=null){let o=document.getElementById("sidebar-content");o.innerHTML="",t.forEach(n=>{let s=document.createElement("button");s.className="w-full flex justify-between items-center px-4 py-2 rounded transition-colors duration-150 hover:bg-yellow-100 cursor-pointer";let i=document.createElement("span");i.textContent=n.date;let r=document.createElement("span");r.textContent=n.interactions.length,r.className="bg-red-500 text-white text-xs font-semibold ml-2 px-2 py-0.5 rounded-full",s.appendChild(i),s.appendChild(r),s.dataset.date=n.date,s.onclick=function(){w&&w!==this&&w.classList.remove("bg-red-400","text-white","font-semibold"),w!==this&&(this.classList.remove("bg-gray-200"),this.classList.add("bg-red-400","text-white","font-semibold"),w=this,g(n.date))},e&&n.date===e&&setTimeout(()=>s.click(),0),o.appendChild(s)})}function F(){let t=document.getElementById("sidebar");window.innerWidth<800?t.style.display="none":t.style.display="flex"}var w,O=y(()=>{v();w=null});function V(t){j=t}function G(){return j}function R(){j=null}var j,Y=y(()=>{j=null});function K(){let t=document.getElementById("interaction-form"),e=document.getElementById("cancel-update");t.addEventListener("submit",ge),e.addEventListener("click",()=>{t.reset(),R(),document.getElementById("submit-button").textContent="Generate",e.classList.add("hidden")})}function ge(t){t.preventDefault();let e=document.getElementById("interaction-form"),o=m(),n=f(),s=o.findIndex(l=>l.date===n),i=G(),r=new FormData(e),d={cn:r.get("calling-number"),in:r.get("incident-number"),name:r.get("name"),reason:r.get("reason-for-calling"),findings:r.get("findings"),resolution:r.get("resolution")};if(Object.values(d).every(l=>!l.trim())){u("Please fill in at least one field before submitting.");return}let a;if(s===-1)a=p({id:`${Date.now()}`,datetime:new Date().toISOString(),completed:!1},d),o.push({date:n,interactions:[a]});else if(i){let l=o[s].interactions.findIndex(b=>b.id===i);if(l!==-1){let b=o[s].interactions[l];a=p(p({},b),d),o[s].interactions[l]=a}}else a=p({id:`${Date.now()}`,datetime:new Date().toISOString(),completed:!1},d),o[s].interactions.unshift(a);localStorage.setItem("interactions",JSON.stringify(o));let L=[a.cn&&`Calling Number: ${a.cn}`,a.in&&`Incident Number: ${a.in}`,a.name&&`Name: ${a.name}`,a.reason&&`Reason for Calling: ${a.reason}`,a.findings&&`Findings: ${a.findings}`,a.resolution&&`Resolution: ${a.resolution}`].filter(Boolean).join(`
`);navigator.clipboard.writeText(L).then(()=>u("Interaction copied to clipboard")).catch(()=>u("Failed to copy interaction")),R(),e.reset(),document.getElementById("submit-button").textContent="Generate",document.getElementById("cancel-update").classList.add("hidden"),g(n),D(m()),setTimeout(()=>{let l=document.querySelector(`[data-id="${a.id}"]`);l&&(l.scrollIntoView({behavior:"smooth",block:"center"}),l.classList.add("ring","ring-yellow-400","ring-offset-2"),setTimeout(()=>{l.classList.remove("ring","ring-yellow-400","ring-offset-2")},1500))},100)}function N(t){let e=document.getElementById("interaction-form");V(t.id),document.getElementById("submit-button").textContent="Update",document.getElementById("cancel-update").classList.remove("hidden"),e["calling-number"].value=t.cn||"",e["incident-number"].value=t.in||"",e.name.value=t.name||"",e["reason-for-calling"].value=t.reason||"",e.findings.value=t.findings||"",e.resolution.value=t.resolution||""}var q=y(()=>{x();v();O();Y();E()});q();O();v();x();var Q=`<template id="interaction-card">
  <div
    class="card bg-white rounded-xl shadow-md p-4 mb-4 transition-colors hover:shadow-lg hover:bg-yellow-50"
    data-id=""
  >
    <div class="flex justify-between items-start mb-2">
      <h2 class="text-xl font-bold reason"></h2>
      <button class="done-button text-gray-500 text-lg">
        <i class="fas fa-check-circle fa-2x"></i>
      </button>
    </div>
    <p class="text-sm text-gray-600 datetime"></p>
    <p class="text-sm text-gray-600 incident-number"></p>
    <p class="text-sm text-gray-600 calling-number"></p>
    <p class="text-sm text-gray-600 name"></p>
    <p class="text-sm text-gray-600 findings"></p>
    <p class="text-sm text-gray-600 resolution"></p>
    <div class="flex justify-end space-x-2 mt-4 button-container">
      <button
        class="copy-incident bg-gray-300 hover:bg-gray-400 text-gray-800 px-2 py-0.5 rounded text-sm"
        title="Copy incident number"
      >
        #
      </button>
      <button
        class="copy-button bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded"
      >
        Copy
      </button>
      <button
        class="update-button bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded"
      >
        Update
      </button>
      <button
        class="delete-button bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded"
      >
        Delete
      </button>
    </div>
  </div>
</template>
`;window.addEventListener("DOMContentLoaded",()=>{F(),window.addEventListener("resize",F),W("import-json");let t=document.createElement("div");t.innerHTML=Q,document.body.appendChild(t),setTimeout(()=>{k()},0);let e=m(),o=f();D(e,o),g(o),K();let n=document.getElementById("export-all");n&&n.addEventListener("click",s=>{s.stopPropagation(),Promise.resolve().then(()=>(v(),z)).then(i=>i.createExportPopup())})});})();
//# sourceMappingURL=bundle.js.map
