(()=>{var J=Object.defineProperty,Q=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var A=(e,t,o)=>t in e?J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,f=(e,t)=>{for(var o in t||(t={}))Z.call(t,o)&&A(e,o,t[o]);if(R)for(var o of R(t))ee.call(t,o)&&A(e,o,t[o]);return e},H=(e,t)=>Q(e,X(t));var y=(e,t)=>()=>(e&&(t=e(e=0)),t);var te=(e,t)=>{for(var o in t)J(e,o,{get:t[o],enumerable:!0})};function u(e,t="success"){let o=document.createElement("div");o.textContent=e,o.className=`fixed bottom-8 left-1/2 transform -translate-x-1/2 px-4 py-2 rounded shadow-lg z-50 text-white text-sm animate-fadeIn ${t==="error"?"bg-red-600":"bg-green-600"}`,document.body.appendChild(o),setTimeout(()=>{o.classList.add("animate-fadeOut")},2500),setTimeout(()=>{o.remove()},3e3)}var I=y(()=>{});function m(){return JSON.parse(localStorage.getItem("interactions"))||[]}function L(e){localStorage.setItem("interactions",JSON.stringify(e))}function p(){let e=new Date;return`${String(e.getMonth()+1).padStart(2,"0")}_${String(e.getDate()).padStart(2,"0")}_${e.getFullYear()}`}function U(e="import-json"){let t=document.getElementById(e);t&&t.addEventListener("change",o=>{let n=o.target.files[0];if(!n)return;let s=new FileReader;s.onload=i=>{try{let r=JSON.parse(i.target.result),d=r.data||r;if(!Array.isArray(d)){u("Invalid backup format.");return}let c=m(),a=ne(c,d);L(a),u("Data imported successfully!"),setTimeout(()=>location.reload(),1500)}catch(r){u("Failed to parse backup file.")}},s.readAsText(n)})}function ne(e,t){let o=new Map;return e.forEach(n=>o.set(n.date,n)),t.forEach(n=>{if(o.has(n.date)){let s=o.get(n.date),i=new Set(s.interactions.map(d=>d.id)),r=n.interactions.filter(d=>!i.has(d.id));s.interactions.push(...r)}else o.set(n.date,n)}),Array.from(o.values())}function C(){return JSON.parse(localStorage.getItem("suggestions")||'{"reason-for-calling":[],"findings":[],"resolution":[]}')}function _(e){localStorage.setItem("suggestions",JSON.stringify(e))}var x=y(()=>{I()});var W={};te(W,{createExportPopup:()=>re,displayInteractions:()=>g});function g(e=p()){let t=document.getElementById("card-list"),n=m().find(i=>i.date===e);if(!n){t.innerHTML='<p class="text-gray-500 text-center">No interactions found for this date.</p>';return}let s=document.getElementById("interaction-card");t.innerHTML="",n.interactions.sort((i,r)=>new Date(r.datetime)-new Date(i.datetime)).forEach(i=>{let r=s.content.cloneNode(!0),d=r.querySelector(".card");d.dataset.id=i.id,i.completed&&(d.classList.add("bg-green-100"),d.querySelector(".done-button").classList.add("text-green-600"),d.querySelectorAll("button").forEach(a=>{a.classList.remove("hover:bg-blue-600","hover:bg-green-600","hover:bg-red-600"),a.classList.add("opacity-50","cursor-default")}),d.classList.add("completed-card")),r.querySelector(".reason").textContent=i.reason||"",r.querySelector(".datetime").textContent=`Date: ${new Date(i.datetime).toLocaleString()}`,r.querySelector(".calling-number").textContent=i.cn?`Calling Number: ${i.cn}`:"",r.querySelector(".incident-number").textContent=i.in?`Incident Number: ${i.in}`:"",r.querySelector(".name").textContent=i.name?`Name: ${i.name}`:"",r.querySelector(".findings").textContent=i.findings?`Findings: ${i.findings}`:"",r.querySelector(".resolution").textContent=i.resolution?`Resolution: ${i.resolution}`:"";let c=r.querySelector(".button-container");c.innerHTML=`
              <button class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-2 py-0.5 rounded text-sm copy-incident" title="Copy incident number">#</button>
              <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mx-2 copy-btn">Copy</button>
              <button class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded mx-2 clone-btn" title="Duplicate this card">Clone</button>
              <button class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded mx-2 update-btn">Update</button>
              <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded mx-2 delete-btn">Delete</button>
            `,d.querySelector(".done-button").addEventListener("click",()=>ie(i.id)),c.querySelector(".copy-incident").addEventListener("click",()=>{navigator.clipboard.writeText(i.in||"").then(()=>u("Incident Number copied"),()=>u("Failed to copy Incident Number"))}),c.querySelector(".copy-btn").addEventListener("click",()=>oe(i.id)),c.querySelector(".update-btn").addEventListener("click",()=>{N(i,()=>g(e));let a=document.getElementById("interaction-form");a&&(a.scrollIntoView({behavior:"smooth",block:"start"}),a.classList.add("ring","ring-yellow-400","ring-offset-2"),setTimeout(()=>{a.classList.remove("ring","ring-yellow-400","ring-offset-2")},1500))}),c.querySelector(".delete-btn").addEventListener("click",()=>se(i.id)),c.querySelector(".clone-btn").addEventListener("click",()=>{let a=m(),S=a.findIndex(l=>l.date===e);if(S!==-1){let l=i,b=`${Date.now()}`,M=H(f({},l),{id:b,datetime:new Date().toISOString(),completed:!1,cn:"",in:"",name:"",reason:l.reason?`${l.reason} (cloned)`:"(cloned)"});a[S].interactions.unshift(M),localStorage.setItem("interactions",JSON.stringify(a)),g(e),setTimeout(()=>{let E=document.querySelector(`[data-id="${b}"]`);E&&(E.scrollIntoView({behavior:"smooth",block:"center"}),E.classList.add("ring","ring-yellow-400","ring-offset-2"),setTimeout(()=>{E.classList.remove("ring","ring-yellow-400","ring-offset-2")},1500)),N(M)},100)}}),t.appendChild(r)})}function T(e){let n=m().flatMap(s=>s.interactions).find(s=>s.id===e);return n?[n.cn&&`Calling Number: ${n.cn}`,n.in&&`Incident Number: ${n.in}`,n.name&&`Name: ${n.name}`,n.reason&&`Reason for Calling: ${n.reason}`,n.findings&&`Findings: ${n.findings}`,n.resolution&&`Resolution: ${n.resolution}`].filter(Boolean).join(`
`):""}function oe(e){let t=T(e);navigator.clipboard.writeText(t).then(()=>u("Copied to clipboard"),()=>u("Copy failed"))}function ie(e){let t=m(),o=p(),n=t.find(s=>s.date===o);if(n){let s=n.interactions.find(i=>i.id===e);s&&(s.completed=!s.completed),L(t),g(o)}}function se(e){let t=m(),o=p(),n=t.find(s=>s.date===o);n&&(n.interactions=n.interactions.filter(s=>s.id!==e),L(t),g(o))}function re(){let e=document.createElement("div");e.className="absolute left-20 bottom-10 bg-white border rounded shadow-lg z-50 w-48 text-sm",[{label:"Today (Text)",value:"today"},{label:"All (Text)",value:"allText"},{label:"All Data (JSON)",value:"allJSON"}].forEach(o=>{let n=document.createElement("button");n.textContent=o.label,n.className="w-full text-left px-4 py-2 hover:bg-gray-100",n.onclick=()=>{ae(o.value),document.body.removeChild(e)},e.appendChild(n)}),document.body.appendChild(e),document.addEventListener("click",o=>{e.contains(o.target)||e.remove()},{once:!0})}function ae(e){let t=m(),o=p();if(e==="today"){let n=t.find(i=>i.date===o);if(!n)return;let s=n.interactions.map(i=>T(i.id)).join(`

--------------------------------------------------------

`);$(s,`interactions_${o}.txt`)}else if(e==="allText"){let n=t.map(s=>{let i=`Date: ${s.date}`,r=s.interactions.map(d=>T(d.id)).join(`

--------------------------------------------------------

`);return`${i}

${r}`}).join(`

============================================================

`);$(n,"interactions_all.txt")}else if(e==="allJSON"){let n=JSON.stringify({data:t},null,2);$(n,"interactions_all.json","application/json")}}function $(e,t,o="text/plain"){let n=new Blob([e],{type:o}),s=URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s)}var B,P,de,le,ce,h,ue,v=y(()=>{x();k();I();x();B=document.getElementById("suggestion-modal"),P=document.getElementById("suggestion-textarea"),de=document.getElementById("save-suggestions"),le=document.getElementById("close-modal"),ce=document.getElementById("modal-title"),h=null,ue={"reason-for-calling":"Reason for Calling",findings:"Findings",resolution:"Resolution"};window.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".suggestion-icon").forEach(t=>{t.addEventListener("click",()=>{h=t.getAttribute("data-field");let o=C();P.value=(o[h]||[]).join(`
`),ce.textContent=`Edit Suggestions: ${ue[h]}`,B.classList.remove("hidden")})}),de.addEventListener("click",()=>{if(!h)return;let t=P.value.split(`
`).map(n=>n.trim()).filter(Boolean),o=C();o[h]=t,_(o),B.classList.add("hidden")}),le.addEventListener("click",()=>{B.classList.add("hidden")}),document.querySelectorAll(".suggest-input").forEach(t=>{let o=t.getAttribute("data-field"),n=document.querySelector(`.suggestions-list[data-for="${o}"]`);t.addEventListener("input",()=>{let s=C()[o]||[],i=t.value.toLowerCase();if(n.innerHTML="",!i)return n.classList.add("hidden");let r=s.filter(d=>d.toLowerCase().includes(i));if(r.length===0)return n.classList.add("hidden");r.forEach(d=>{let c=document.createElement("li");c.textContent=d,c.className="px-2 py-1 cursor-pointer hover:bg-blue-100",c.addEventListener("click",()=>{t.value=d,n.classList.add("hidden")}),n.appendChild(c)}),n.classList.remove("hidden")}),t.addEventListener("blur",()=>setTimeout(()=>n.classList.add("hidden"),200))})})});function D(e,t=null){let o=document.getElementById("sidebar-content");o.innerHTML="",e.forEach(n=>{let s=document.createElement("button");s.className="w-full flex justify-between items-center px-4 py-2 rounded transition-colors duration-150 hover:bg-yellow-100 cursor-pointer";let i=document.createElement("span");i.textContent=n.date;let r=document.createElement("span");r.textContent=n.interactions.length,r.className="bg-red-500 text-white text-xs font-semibold ml-2 px-2 py-0.5 rounded-full",s.appendChild(i),s.appendChild(r),s.dataset.date=n.date,s.onclick=function(){w&&w!==this&&w.classList.remove("bg-red-400","text-white","font-semibold"),w!==this&&(this.classList.remove("bg-gray-200"),this.classList.add("bg-red-400","text-white","font-semibold"),w=this,g(n.date))},t&&n.date===t&&setTimeout(()=>s.click(),0),o.appendChild(s)})}function q(){let e=document.getElementById("sidebar");window.innerWidth<800?e.style.display="none":e.style.display="flex"}var w,F=y(()=>{v();w=null});function z(e){O=e}function V(){return O}function j(){O=null}var O,G=y(()=>{O=null});function Y(){let e=document.getElementById("interaction-form"),t=document.getElementById("cancel-update");e.addEventListener("submit",me),t.addEventListener("click",()=>{e.reset(),j(),document.getElementById("submit-button").textContent="Generate",t.classList.add("hidden")})}function me(e){e.preventDefault();let t=document.getElementById("interaction-form"),o=m(),n=p(),s=o.findIndex(l=>l.date===n),i=V(),r=new FormData(t),d={cn:r.get("calling-number"),in:r.get("incident-number"),name:r.get("name"),reason:r.get("reason-for-calling"),findings:r.get("findings"),resolution:r.get("resolution")};if(Object.values(d).every(l=>!l.trim())){u("Please fill in at least one field before submitting.");return}let a;if(s===-1)a=f({id:`${Date.now()}`,datetime:new Date().toISOString(),completed:!1},d),o.push({date:n,interactions:[a]});else if(i){let l=o[s].interactions.findIndex(b=>b.id===i);if(l!==-1){let b=o[s].interactions[l];a=f(f({},b),d),o[s].interactions[l]=a}}else a=f({id:`${Date.now()}`,datetime:new Date().toISOString(),completed:!1},d),o[s].interactions.unshift(a);localStorage.setItem("interactions",JSON.stringify(o));let S=[a.cn&&`Calling Number: ${a.cn}`,a.in&&`Incident Number: ${a.in}`,a.name&&`Name: ${a.name}`,a.reason&&`Reason for Calling: ${a.reason}`,a.findings&&`Findings: ${a.findings}`,a.resolution&&`Resolution: ${a.resolution}`].filter(Boolean).join(`
`);navigator.clipboard.writeText(S).then(()=>u("Interaction copied to clipboard")).catch(()=>u("Failed to copy interaction")),j(),t.reset(),document.getElementById("submit-button").textContent="Generate",document.getElementById("cancel-update").classList.add("hidden"),g(n),D(m()),setTimeout(()=>{let l=document.querySelector(`[data-id="${a.id}"]`);l&&(l.scrollIntoView({behavior:"smooth",block:"center"}),l.classList.add("ring","ring-yellow-400","ring-offset-2"),setTimeout(()=>{l.classList.remove("ring","ring-yellow-400","ring-offset-2")},1500))},100)}function N(e){let t=document.getElementById("interaction-form");z(e.id),document.getElementById("submit-button").textContent="Update",document.getElementById("cancel-update").classList.remove("hidden"),t["calling-number"].value=e.cn||"",t["incident-number"].value=e.in||"",t.name.value=e.name||"",t["reason-for-calling"].value=e.reason||"",t.findings.value=e.findings||"",t.resolution.value=e.resolution||""}var k=y(()=>{x();v();F();G();I()});k();F();v();x();var K=`<template id="interaction-card">
  <div
    class="card bg-white rounded-xl shadow-md p-4 mb-4 transition-colors hover:shadow-lg hover:bg-yellow-50"
    data-id=""
  >
    <div class="flex justify-between items-start mb-2">
      <h2 class="text-xl font-bold reason"></h2>
      <button class="done-button text-gray-500 text-lg">
        <i class="fas fa-check-circle fa-2x"></i>
      </button>
    </div>
    <p class="text-sm text-gray-600 datetime"></p>
    <p class="text-sm text-gray-600 incident-number"></p>
    <p class="text-sm text-gray-600 calling-number"></p>
    <p class="text-sm text-gray-600 name"></p>
    <p class="text-sm text-gray-600 findings"></p>
    <p class="text-sm text-gray-600 resolution"></p>
    <div class="flex justify-end space-x-2 mt-4 button-container">
      <button
        class="copy-incident bg-gray-300 hover:bg-gray-400 text-gray-800 px-2 py-0.5 rounded text-sm"
        title="Copy incident number"
      >
        #
      </button>
      <button
        class="copy-button bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded"
      >
        Copy
      </button>
      <button
        class="update-button bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded"
      >
        Update
      </button>
      <button
        class="delete-button bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded"
      >
        Delete
      </button>
    </div>
  </div>
</template>
`;window.addEventListener("DOMContentLoaded",()=>{q(),window.addEventListener("resize",q),U("import-json");let e=document.createElement("div");e.innerHTML=K,document.body.appendChild(e);let t=m(),o=p();D(t,o),g(o),Y();let n=document.getElementById("export-all");n&&n.addEventListener("click",s=>{s.stopPropagation(),Promise.resolve().then(()=>(v(),W)).then(i=>i.createExportPopup())})});})();
//# sourceMappingURL=bundle.js.map
